<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Customer's Basket</title>
    <link href='ready/css/RobotoSlab-Regular.ttf' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="font-awesome-4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="ready/css/style.css">
    <link rel="stylesheet" href="ready/css/bigbox.css" />
    <link rel="stylesheet" href="ready/css/jquery.validity.css" />
    <script src="ready/js/jquery-2.1.4.min.js"></script>
    <script src="ready/js/jquery.validity.js"></script>
    <script src="ready/js/humane.min.js"></script>
</head>

<body>

<div class="container-fluid">
    <div class="header fl1" style="border-bottom: 10px solid #ffa571;">
        <img id="logo" src="images/icons/logo.png" alt="logo" width="50px" height="70px" />
        <h1 style="color: white">Jewellery webBasket</h1>
        <ul style="align-content: flex-end; justify-content: flex-end; margin: 20px; width: 200px">
            <li><a class="button" href="#"><i style="color: #fff;" class="fa fa-bars"></i> Main</a>
                <ul class="dropdown">
                    <li><a href="index.html" class="button"><i style="color: #fff;" class="fa fa-diamond"></i> Home</a></li>
                    <li><a href="index1.html" class="button"><i style="color: #fff;" class="fa fa-diamond"></i> Celeb's</a></li>
                    <li><a href="index2.html" class="button"><i style="color: #fff;" class="fa fa-diamond"></i> About</a></li>
                    <li><a href="index3.html" class="button"><i style="color: #fff;" class="fa fa-diamond"></i> Info</a></li>
                </ul>
            </li>
        </ul>
    </div>
    <style>
        a {
            color: #fefdff;
            text-transform: uppercase;
            font-weight: bold;
            text-decoration: none;
        }
        a:hover {
            color: #030303;
            font-weight: bold;
        }
        label {
            color: white;
            font-weight: 400;
            font-family: 'Arial', sans-serif;
            font-size: 14px;
        }
    </style>
    <div id="cartDiv" style="display: flex; flex-direction: column; align-content: center; margin: 30px auto; border: 7px solid lightcoral; border-radius: 1em; background: url('images/icons/hsf.png'); min-width: 300px">
        <h1 style="color: #ffcc8a; text-transform: uppercase; text-align: center; padding: 20px;">Personal Cart</h1>
        <div>
            <ul id="show-cart">
            </ul>
            <div id="shipping" style="display: flex; flex-direction: column; align-content: center; padding: 20px">
                <p style="color: #fefdff; text-transform: uppercase; text-align: center;">Choose shipping method</p>
                <select name="shippingMethod" id="ship" style="color: #060606; text-transform: uppercase; text-align: center; align-self: center">
                    <option value="free" data-price="0">Free 0$</option>
                    <option value="standart" data-price="7">Standart 7$</option>
                    <option value="express" data-price="12">Express 12$</option>
                    <option value="2nd day air" data-price="26">2nd day air 26$</option>
                    <option value="overnight" data-price="40">Overnight 40$</option>
                </select>
            </div>
            <div style="display: flex; flex-direction: column; align-content: center; align-items: center;">
                <label for="0">Visa/Master</label>
                <input required id="0" type="text" maxlength="19" placeholder="0000-0000-0000-0000"/>
                <label for="1">Name, Surname</label>
                <input required id="1" type="text" placeholder="Vasiliy Utkin"/>
                <label for="2">Adress(country, city, street, apartment)</label>
                <input required id="2" type="text" placeholder="Ukraine, Kiev, ..."/>
                <label for="3">Contact#</label>
                <input required id="3" type="tel" placeholder="+38(067)2345181"/>
                <label for="4">@Email</label>
                <input required id="4" type="email" placeholder="lui1900@gmail.com"/>
            </div>
            <div style="color: #fffef6; text-transform: uppercase; text-align: center; padding: 20px">You have <span id="count-cart"></span> items in your Basket</div>
            <div style="color: #ffe8fe; text-transform: uppercase; text-align: center; padding: 20px">Total Cart: <span id="total-cart"></span>$</div>
        </div>
        <a style="color: #fffafa; text-transform: uppercase; text-align: center; text-decoration: none; padding: 20px" href="#" id="clear-cart">Clear Basket</a>
        <a style="color: #fbf8ff; text-transform: uppercase; text-align: center; text-decoration: none; padding: 20px" href="#" id="bill">BUY</a>
    </div>

    <div class="footer fl4" style="border-top: 10px solid #ffa571;">
        <ul class="footer-nav">
            <li><a href="http://instagram.com/jessee"><i class="fa fa-instagram fa-2x"></i></a></li>
            <li><a href="http://vk.com/jessee"><i class="fa fa-vk fa-2x"></i></a></li>
            <li><a href="http://facebook.com/jessee"><i class="fa fa-facebook fa-2x"></i></a></li>
            <li><a href="http://youtube.com/jessee"><i class="fa fa-youtube fa-2x"></i></a></li>
            <li><a href="http://twitter.com/jessee"><i class="fa fa-twitter fa-2x"></i></a></li>
            <li><a href="http://tumblr.com/jessee"><i class="fa fa-tumblr fa-2x"></i></a></li>
        </ul>
        <div class="fp">
            <p>Make transactions via <img src="images/icons/visa.png" alt="visa" />
                <img src="images/icons/l4594-mastercard-master-c-logo-66661.png" alt="master" /></p>
            <p><i class="fa fa-phone fa-lg"></i> +390-99-4298-2921</p>
            <p><i class="fa fa-creative-commons fa-lg"></i> 2015 Jewellery webBasket</p>
            <p><i class="fa fa-chrome fa-lg"></i> Design by AndI</p>
        </div>
        <div class="fp2">
            <p>Copyright Â© 2015 Sin City Tech - A Relight, Cypress Hill, South Carolina Web Design Development</p>
            <p>All rights reserved. All trademarks referenced herein are the properties of their respective owners.</p>
        </div>
    </div>

</div>

<script>
    //Shopping cart functions
    //cart : Array
    //Item : Object/Class
    // addItemToCart : Function
    // removeItemFromCart : Function
    // removeItemFromCartAll : Function
    // clearCart : Function
    // countCart : Function
    // totalCart : Function
    // saveCart : Function
    // loadCart : Function
    var shoppingCart = (function () {
        //private methods and properties
        var cart = [];

        function Item(name, price, count) {
            this.name = name;
            this.price = price;
            this.count = count;
        }

        function loadCart() {
            cart = JSON.parse(localStorage.getItem('shoppingCart'));
        }
        loadCart();

        //public methods and properties

        var obj = {};

        obj.saveCart = function () {
            localStorage.setItem('shoppingCart', JSON.stringify(cart));
        };
        obj.addItemToCart = function (name, price, count) {
            for (var i in cart) {
                if (cart[i].name === name) {
                    cart[i].count += count;
                    obj.saveCart();
                    return;
                }
            }
            var item = new Item(name, price, count);
            cart.push(item);
            obj.saveCart();
        };

        obj.removeItemFromCart = function (name) {
            for (var i in cart) {
                if (cart[i].name == name) {
                    cart[i].count--;
                    if (cart[i].count == 0) {
                        cart.splice(i, 1)
                    }
                    break;
                }
            }
            obj.saveCart();
        };

        obj.discount = function () {
            return 'JS' + parseInt(([].slice.call((Math.random().toFixed(4)), 2)).join(''))
        };

        obj.removeItemFromCartAll = function (name) {
            for (var i in cart) {
                if (cart[i].name == name) {
                    cart.splice(i, 1);
                    break;
                }
            }
            obj.saveCart();
        };

        obj.clearCart = function () {
            cart = [];
            obj.saveCart();
        };

        obj.countCart = function () {
            var totalCount = 0;
            for (var i in cart) {
                totalCount += cart[i].count;
            }
            return totalCount;
        };

        obj.totalCart = function () {
            var totalCost = 0;
            var e = document.getElementById('ship');
            var shipPrice = Number(e.options[e.selectedIndex].getAttribute('data-price'));
            for (var i in cart) {
                totalCost += cart[i].price * cart[i].count;
            }
            return (totalCost + shipPrice).toFixed(2);
        };
        obj.totalCartPromo = function () {
            var totalCost = 0;
            var e = document.getElementById('ship');
            var shipPrice = Number(e.options[e.selectedIndex].getAttribute('data-price'));
            for (var i in cart) {
                totalCost += cart[i].price * cart[i].count * 0.85;
            }
            return (totalCost + shipPrice).toFixed(2);
        };

        obj.listCart = function () {
            var cartCopy = [];
            for (var i in cart) {
                var item = cart[i],
                        itemCopy = {};
                for (var prop in item) {
                    itemCopy[prop] = item[prop];
                }
                itemCopy.total = (item.price * item.count).toFixed(2);
                cartCopy.push(itemCopy);
            }
            return cartCopy;
        };
        return obj;
    })();

    //*********************************************************
$(document).ready(function() {
    $('#cartDiv a').click(function(e) {
        e.preventDefault();
    });
    //modifying a DOM tree
    $('.add-to-cart').click(function (event) {
        event.preventDefault();
        var name = $(this).attr('data-name');
        var price = Number($(this).attr('data-price'));
        shoppingCart.addItemToCart(name, price, 1);
        humane.log('Item: ' + name + ' added to cart, your total bill is: ' + shoppingCart.totalCart() + '$');
        displayCart();
    });
    $('#clear-cart').click(function () {
        shoppingCart.clearCart();
        displayCart();
        shoppingCart.saveCart();
    });

    function displayCart() {
        var cartArray = shoppingCart.listCart();
        var output = '';
        for (var i in cartArray) {
            output += "<li>" + cartArray[i].name + " " + cartArray[i].count + " x " + cartArray[i].price + "$ = " + cartArray[i].total + "<a href='#' class='substract-item' data-name='" + cartArray[i].name + "'>-</a> <a class='plus-item' href='#' data-name='" + cartArray[i].name + "'>+</a>" + " <a class='delete-item' href='#' data-name='" + cartArray[i].name + "'>x</a>" + "</li>"
        }
        $('#show-cart').html(output);
        $('#count-cart').html(shoppingCart.countCart());
        $('#total-cart').html(shoppingCart.totalCart());
        $('#cart-count').html(shoppingCart.countCart());
    }

    $('#show-cart').on('click', '.delete-item', function (event) {
        event.preventDefault();
        var name = $(this).attr('data-name');
        shoppingCart.removeItemFromCartAll(name);
        displayCart();
    });
    $('#show-cart').on('click', '.substract-item', function (event) {
        event.preventDefault();
        var name = $(this).attr('data-name');
        shoppingCart.removeItemFromCart(name);
        displayCart();
    });
    $('#show-cart').on('click', '.plus-item', function (event) {
        event.preventDefault();
        var name = $(this).attr('data-name');
        shoppingCart.addItemToCart(name, 0, 1);
        displayCart();
    });
    $('#bill').click(function (e) {
        e.preventDefault();
        if (Number(shoppingCart.totalCart()) == 0 || Number(shoppingCart.totalCart()) == 7 || Number(shoppingCart.totalCart()) == 12 || Number(shoppingCart.totalCart()) == 26 || Number(shoppingCart.totalCart()) == 40 || Number(shoppingCart.totalCartPromo()) == 0 || Number(shoppingCart.totalCartPromo()) == 7 || Number(shoppingCart.totalCartPromo()) == 12 || Number(shoppingCart.totalCartPromo()) == 26 || Number(shoppingCart.totalCartPromo()) == 40) {
            humane.log('we couldn\'t deliver nothing to you, cart is empty =(');
            displayCart();
        } else if($('#0').val() == '' || $('#1').val() == '' || $('#2').val() == '' || $('#3').val() == '' || $('#4').val() == '') {
            humane.log('Fill all fields, please! We need to know where we should deliver your goods!');
        } else {
            humane.log('<strong>Your total bill is: ' + shoppingCart.totalCart() + '$! Thank you for your purchase! See you around =_)</strong>');
            shoppingCart.clearCart();
            shoppingCart.saveCart();
            displayCart();
        }
    });
    displayCart();

    //*****************************************************************************

});
</script>
</body>

</html>